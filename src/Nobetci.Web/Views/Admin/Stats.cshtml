@model AdminStatsViewModel
@using Nobetci.Web.Controllers
@{
    ViewData["Title"] = "Ä°statistikler";
    Layout = "_AdminLayout";
}

<div class="admin-header">
    <h2>ğŸ“ˆ Ä°statistikler</h2>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <span class="stat-icon">ğŸ‘ï¸</span>
        <div class="stat-label">BugÃ¼n</div>
        <div class="stat-value">@Model.TodayVisits</div>
    </div>
    
    <div class="stat-card">
        <span class="stat-icon">ğŸ“…</span>
        <div class="stat-label">Bu Hafta</div>
        <div class="stat-value">@Model.WeekVisits</div>
    </div>
    
    <div class="stat-card">
        <span class="stat-icon">ğŸ“†</span>
        <div class="stat-label">Bu Ay</div>
        <div class="stat-value">@Model.MonthVisits</div>
    </div>
    
    <div class="stat-card">
        <span class="stat-icon">ğŸ“Š</span>
        <div class="stat-label">Toplam</div>
        <div class="stat-value">@Model.TotalVisits</div>
    </div>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <span class="stat-icon">ğŸŒ</span>
        <div class="stat-label">Unique IP</div>
        <div class="stat-value">@Model.UniqueIPs</div>
    </div>
    
    <div class="stat-card">
        <span class="stat-icon">ğŸ“„</span>
        <div class="stat-label">Toplam Sayfa</div>
        <div class="stat-value">@Model.TotalPages</div>
    </div>
    
    <div class="stat-card">
        <span class="stat-icon">âœ…</span>
        <div class="stat-label">YayÄ±ndaki Sayfa</div>
        <div class="stat-value">@Model.PublishedPages</div>
    </div>
    
    <div class="stat-card">
        <span class="stat-icon">ğŸ‘¥</span>
        <div class="stat-label">Toplam Personel</div>
        <div class="stat-value">@Model.TotalEmployees</div>
    </div>
</div>

<div class="grid-2">
    <div class="card">
        <div class="card-header">
            <span class="card-title">ğŸ”¥ En Ã‡ok Ziyaret Edilen Sayfalar</span>
        </div>
        <table class="table">
            <thead>
                <tr>
                    <th>Sayfa</th>
                    <th style="text-align: right;">Ziyaret</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var pg in Model.TopPages)
                {
                    <tr>
                        <td class="truncate">@pg.Path</td>
                        <td style="text-align: right;">
                            <span class="badge badge-info">@pg.Count</span>
                        </td>
                    </tr>
                }
                @if (!Model.TopPages.Any())
                {
                    <tr>
                        <td colspan="2" style="text-align: center; color: #94a3b8;">Veri yok</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    
    <div class="card">
        <div class="card-header">
            <span class="card-title">ğŸ“± Cihaz DaÄŸÄ±lÄ±mÄ±</span>
        </div>
        <table class="table">
            <thead>
                <tr>
                    <th>Cihaz</th>
                    <th style="text-align: right;">SayÄ±</th>
                    <th style="text-align: right;">Oran</th>
                </tr>
            </thead>
            <tbody>
                @{
                    var totalDevices = Model.DeviceStats.Sum(d => d.Count);
                }
                @foreach (var device in Model.DeviceStats)
                {
                    var icon = device.Type switch
                    {
                        "Desktop" => "ğŸ–¥ï¸",
                        "Mobile" => "ğŸ“±",
                        "Tablet" => "ğŸ“²",
                        "Bot" => "ğŸ¤–",
                        _ => "â“"
                    };
                    var percentage = totalDevices > 0 ? (device.Count * 100.0 / totalDevices) : 0;
                    <tr>
                        <td>@icon @device.Type</td>
                        <td style="text-align: right;">@device.Count</td>
                        <td style="text-align: right;">
                            <span class="badge badge-success">%@percentage.ToString("F1")</span>
                        </td>
                    </tr>
                }
                @if (!Model.DeviceStats.Any())
                {
                    <tr>
                        <td colspan="3" style="text-align: center; color: #94a3b8;">Veri yok</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <span class="card-title">ğŸŒ Browser DaÄŸÄ±lÄ±mÄ±</span>
    </div>
    <table class="table">
        <thead>
            <tr>
                <th>Browser</th>
                <th style="text-align: right;">Ziyaret</th>
                <th style="text-align: right;">Oran</th>
            </tr>
        </thead>
        <tbody>
            @{
                var totalBrowsers = Model.BrowserStats.Sum(b => b.Count);
            }
            @foreach (var browser in Model.BrowserStats)
            {
                var percentage = totalBrowsers > 0 ? (browser.Count * 100.0 / totalBrowsers) : 0;
                <tr>
                    <td>@browser.Name</td>
                    <td style="text-align: right;">@browser.Count</td>
                    <td style="text-align: right;">
                        <div style="display: flex; align-items: center; justify-content: flex-end; gap: 8px;">
                            <div style="width: 100px; height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden;">
                                <div style="width: @percentage%; height: 100%; background: #3b82f6;"></div>
                            </div>
                            <span style="font-size: 0.8rem; color: #64748b;">%@percentage.ToString("F1")</span>
                        </div>
                    </td>
                </tr>
            }
            @if (!Model.BrowserStats.Any())
            {
                <tr>
                    <td colspan="3" style="text-align: center; color: #94a3b8;">Veri yok</td>
                </tr>
            }
        </tbody>
    </table>
</div>

