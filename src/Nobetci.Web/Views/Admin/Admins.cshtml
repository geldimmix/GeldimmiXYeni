@model List<Nobetci.Web.Data.Entities.AdminUser>
@{
    ViewData["Title"] = "Admin Kullanƒ±cƒ±larƒ±";
}

<div class="admin-header">
    <h2>
        <span>üîê</span>
        Admin Kullanƒ±cƒ±larƒ±
    </h2>
    <div class="header-actions">
        <a href="/admin/admins/create" class="btn btn-primary">
            <span>‚ûï</span>
            Yeni Admin
        </a>
    </div>
</div>

<div class="card" style="padding: 0; overflow: hidden;">
    <div style="overflow-x: auto;">
        <table class="table" style="margin: 0;">
            <thead>
                <tr>
                    <th style="text-align: center; width: 60px;">ID</th>
                    <th style="padding-left: 20px;">Kullanƒ±cƒ±</th>
                    <th>Email</th>
                    <th style="text-align: center;">Rol</th>
                    <th style="text-align: center;">Durum</th>
                    <th>Son Giri≈ü</th>
                    <th style="text-align: center; padding-right: 20px;">ƒ∞≈ülemler</th>
                </tr>
            </thead>
            <tbody>
                @if (!Model.Any())
                {
                    <tr>
                        <td colspan="7">
                            <div class="empty-state" style="padding: 60px 20px;">
                                <div class="icon">üîê</div>
                                <div class="title">Hen√ºz admin kullanƒ±cƒ± yok</div>
                                <a href="/admin/admins/create" class="btn btn-primary" style="margin-top: 16px;">
                                    <span>‚ûï</span>
                                    ƒ∞lk Admin'i Olu≈ütur
                                </a>
                            </div>
                        </td>
                    </tr>
                }
                @foreach (var admin in Model)
                {
                    <tr>
                        <td style="text-align: center;">
                            <span class="badge badge-info">#@admin.Id</span>
                        </td>
                        <td style="padding-left: 20px;">
                            <div style="font-weight: 700; color: var(--text-primary);">@admin.Username</div>
                            @if (!string.IsNullOrEmpty(admin.FullName))
                            {
                                <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 2px;">@admin.FullName</div>
                            }
                        </td>
                        <td>
                            @if (!string.IsNullOrEmpty(admin.Email))
                            {
                                <span style="color: var(--text-secondary); font-size: 0.9rem;">@admin.Email</span>
                            }
                            else
                            {
                                <span style="color: var(--text-muted);">‚Äî</span>
                            }
                        </td>
                        <td style="text-align: center;">
                            @if (admin.Role == Nobetci.Web.Data.Entities.AdminRoles.SuperAdmin)
                            {
                                <span class="badge badge-warning">‚≠ê SuperAdmin</span>
                            }
                            else if (admin.Role == Nobetci.Web.Data.Entities.AdminRoles.Admin)
                            {
                                <span class="badge badge-purple">Admin</span>
                            }
                            else
                            {
                                <span class="badge badge-info">Viewer</span>
                            }
                        </td>
                        <td style="text-align: center;">
                            @if (admin.IsActive)
                            {
                                <span class="badge badge-success">‚úì Aktif</span>
                            }
                            else
                            {
                                <span class="badge badge-danger">‚úó Pasif</span>
                            }
                        </td>
                        <td>
                            @if (admin.LastLoginAt.HasValue)
                            {
                                <div style="font-size: 0.85rem; font-weight: 500;">@admin.LastLoginAt.Value.ToString("dd.MM.yyyy")</div>
                                <div style="font-size: 0.7rem; color: var(--text-muted);">@admin.LastLoginAt.Value.ToString("HH:mm")</div>
                            }
                            else
                            {
                                <span style="color: var(--text-muted); font-size: 0.85rem;">‚Äî</span>
                            }
                        </td>
                        <td style="text-align: center; padding-right: 20px;">
                            <div style="display: flex; gap: 8px; justify-content: center;">
                                <a href="/admin/admins/edit/@admin.Id" class="btn btn-sm btn-primary">
                                    <span>‚úèÔ∏è</span>
                                    D√ºzenle
                                </a>
                                <button class="btn btn-sm btn-danger" onclick="deleteAdmin(@admin.Id, '@admin.Username')">
                                    <span>üóëÔ∏è</span>
                                    Sil
                                </button>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<script>
function deleteAdmin(id, username) {
    const confirmMessage = '@Html.Raw(Localizer["AdminUserWillBeDeleted"].Value.Replace("\"", "\\\""))'.replace('{0}', username);
    if (confirm(confirmMessage)) {
        fetch('/admin/admins/delete/' + id, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                location.reload();
            } else {
                alert(data.error || '@Localizer["DeleteFailed"].Value');
            }
        })
        .catch(err => {
            alert('@Localizer["AnErrorOccurred"].Value');
        });
    }
}
</script>
